@import helper._

@main("Research Interest Graph") {

    <!-- MAIN CONTAINER -->
    <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 2rem 1rem; background-color: #f9f9f9; border-radius: 8px;">

        <!-- Research Dashboard Heading -->
        <h2 style="text-align: center; margin-bottom: 2rem; font-weight: 700; font-size: 2rem;">
            Research Dashboard
        </h2>

        <!-- CARD 1: Research Interests (Word Cloud) -->
        <div class="section-card"
             style="
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.1);
                padding: 2rem;
                margin-bottom: 2rem;
             ">
            <h5 style="font-weight: 700; text-align: center; margin-bottom: 1.5rem; font-size: 1.5rem;">
                Research Interests
            </h5>
            <div style="text-align: center;">
                <img
                  src="@routes.Assets.at("resource/acm_category_wordcloud.png")"
                  alt="Combined Topic Word Cloud"
                  style="max-width: 90%; height: auto;"
                />
            </div>
        </div>

        <!-- CARD 2: Donut Chart + Year Selector -->
        <div class="section-card"
             style="
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.1);
                padding: 2rem;
                margin-bottom: 2rem;
             ">
            <h5 style="font-weight: 700; text-align: center; margin-bottom: 1.5rem; font-size: 1.5rem;">
                Research Areas Distribution
            </h5>
            <div style="
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
                gap: 2rem;
            ">
                <!-- Donut Chart Container -->
                <div
                  id="pieChart"
                  style="
                    width: 400px;
                    height: 400px;
                    border: 2px solid #ddd;
                    border-radius: 12px;
                    padding: 1rem;
                  ">
                </div>

                <!-- No Jobs Match/Found -->
                 <div id="noDataMessage" style="display: none; font-size: 1.2rem; color: #888; text-align: center;">
                    No jobs match the selected criteria.

                <!-- Year Selector using Select2 -->
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <label for="yearSelector" style="font-weight: 600; margin-bottom: 0.5rem; font-size: 1.1rem;">
                        Select Year
                    </label>
                    <select id="yearSelector" style="width: 240px;">
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
            </div>
        </div>

        <!-- CARD 3: Stacked Bar Chart -->
        <div class="section-card"
             style="
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.1);
                padding: 2rem;
             ">
            <h5 style="font-weight: 700; text-align: center; margin-bottom: 1.5rem; font-size: 1.5rem;">
                Research Areas by Year
            </h5>
            <div
              id="stackedBarChart"
              style="
                width: 100%;
                height: 500px;
                margin: 0 auto;
                border: 2px solid #ddd;
                border-radius: 12px;
                padding: 1rem;
                overflow: hidden;
              ">
            </div>
        </div>

        <!-- CARD 4: Simplified Dashboard -->
         <div class="dashboard-controls">
            <div id="summary-statistics">
                <span>Total Jobs: <b id="total-jobs-display">--</b></span>
                <span>Average Pay: <b id="average-pay-display">--</b></span>
            </div>
        
        <div class="view-toggles" style="margin-bottom: 1rem;">
            <label>Show:</label>
            <button class="btn btn-sm btn-outline-primary" onclick="toggleView('all')">All</button>
            <button class="btn btn-sm btn-outline-secondary" onclick="toggleView('pieChart')">Distribution</button>
            <button class="btn btn-sm btn-outline-secondary" onclick="toggleView('stackedBarChart')">History</button>
        </div>

            <button id="resetFiltersBtn" class="btn">Reset Features</button>
         </div>
    </div> 

    <!-- End Container -->

    <!-- *********************
         PAGE-SPECIFIC SCRIPTS
         ********************* -->

    <!-- Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- ApexCharts JS -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Dashboard Configuration With Javascript File Route For Core Logic -->
    <script>
        window.DASHBOARD_CONFIGURATION = {
            dataURL: '@routes.Assets.at("resource/yearly_lda_acm_distribution.json")',
            initialYear: 2024,
            // Backend is hosting on port 9039 as mentioned in README
            // userID is hardcoded to 1 for simplicity
            jobListAPIURL: "http://localhost:9039/job/jobList/1?pageLimit=100&pageNum=1&sortCriteria=id"
        };
    </script>

    <script src="@routes.Assets.at("javascripts/dashboard.js")" type="text/javascript"></script>